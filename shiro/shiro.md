# 一、权限管理相关知识

- 数据的权限
- 资源的权限

## 1、认证

（1）登录方式的演进

- 账号密码
- 手机验证码/邮箱
- 第三方应用授权的登录
- 单点登录

（2）密码加密

## 2、权限管理

### （1）数据模型

- RABC理论基础
- 用户（用户组）
- 角色（角色组）
- 资源
  - 菜单
  - 按钮
  - 普通链接

**例子**：

deptId如何储存？

真实项目中，部门可能超级多，有人员变动等问题：离职、异动

性能问题：

- 小项目存储：递归（速度低）、parentId、fullName、path(/000/0001)
- 大项目：用es，数据量大，查询部门范围内的数据

### （2）范围大小

- 粗粒度
  - 菜单
  - 权限
  - 按钮
- 细粒度
  - 数据权限

# 二、shiro简介

[官网](https://shiro.apache.org/)

## 1、组成

**基础组件**

- Authentication：提供用户识别，也就是登录
- Authorization：访问控制，也就是授权
- Cryptography：自带加密算法保证数据安全
- Session Management：会话管理

特性：session信息，能在多线程代码中获取到

## 2、核心概念

**（1）Subject**

**（2）SecurityManager**

shiro核心组件，相当于SpringMVC中的的dispatcherServlet，管理subject，认证授权会话以及缓存的管理

- SessionManager：session管理
- SessionDAO：数据访问对象，如果分布式登录可扩展DAO接口
- CacheManager：缓存管理
- Cryptography：加密策略

**（3）Realms**

充当Shiro和应用程序安全数据之间的“桥梁”或“连接器”。也就是说，当需要与安全相关数据（如用户帐户）进行实际交互以执行身份验证（登录）和授权（访问控制）时，Shiro会从为应用程序配置的一个或多个Realms中查找其中的许多内容。

# 三、初级使用

## 1、基本名词

**Subject**：应用程序用户的特定安全用户 "视图"。它可以是一个人，一个第三方进程，一个连接到你的应用程序的服务器，甚至是一个cron作业。基本上，它可以是与你的应用程序通信的任何东西或任何人

**principals**：一个主体的识别属性

**credentials**：用于验证身份的秘密 数据。密码、生物识别数据证书等	

**Realms**：特定于安全的DAO、数据访问对象、与后端数据源对话的软件组件。如果你在 LDAP 中有用户名和密码，那么你将有一个 LDAP Realm 与 LDAP 通信。这个想法是，你将使用每个后端数据源的一个域，Shiro将知道如何与这些域一起协调，以完成你必须做的事情

2:15:40

