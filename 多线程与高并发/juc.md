

线程的历史——一部对CPU性能压榨的历史

- 单进程人工切换：纸带机
- 多进程批处理：多个任务批量执行
- 多进程并行处理：把程序写在不同的内存位置上来回切换
- 多线程：selector - epoll
- 线程/协程：绿色线程，用户管理的（而不是OS管理的）线程



进程、线程：



<img src="img\计算机的组成.png" />

进程：双击“QQ.exe”，会把程序放入到内存中，这就是一个进程，再双击一次，又加载到内存中，又是另一个进程。是操作系统进行资源分配和调度的基本单位。（QQ.exe就是程序）

线程：线程共享进程所分配到的“资源”。以线程为单位执行，会找到“QQ.exe”的主线程（main）开始执行

线程切换：执行T1：指令加载到PC，registers存数据，ALU计算。切换线程把信息放到缓存中，再执行T2

<img src="img\线程切换.png" />

问题：

单核CPU设定多线程是否有意义？

（1）一个核同一时刻只能执行一个线程。

有意义：一个线程不是所有时间都在使用cpu，比如在等待网络输入。

CPU密集型：线程大量时间在做计算

IO密集型：线程大量时间在做IO操作（比如拷贝文件）

（2）工作线程数是不是设置的越大越好？

线程切换也需要消耗资源，会花大量时间在切换线程上。

2-2